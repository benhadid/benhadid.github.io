<!DOCTYPE html>
<html>

  <head>
  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title> Travaux Pratiques #4 - Introduction à MARS - Architecture des ordinateurs / Automne 2020 </title>
  <meta name="description" content="Objectifs  Get familiar with the MARS simulator.  Learn how to assemble, run, and debug a MIPS program.Le Simulateur MARSMARS, the Mips Assembly and Runtime ...">
  
  <link rel="stylesheet" href="/l2ado/_css/main.css">
  <link rel="canonical" href="http://benhadid.github.io//l2ado/labs/04_lab">
  <link rel="alternate" type="application/rss+xml" title="Architecture des ordinateurs / Automne 2020 - " href="http://benhadid.github.io//l2ado/feed.xml" />
<link rel='stylesheet' id='open-sans-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C300%2C400%2C600&#038;subset=latin%2Clatin-ext&#038;ver=4.2.4' type='text/css' media='all' />
<link href='https://fonts.googleapis.com/css?family=Titillium+Web:600italic,600,400,400italic' rel='stylesheet' type='text/css'>




<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

<!-- MathJax -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper" style="z-index: 100;">
      <table><tr>
          <td><img width="75" src="/l2ado/_images/logo.png" valign="middle"></td>
          <td style="padding-left:10px;"><a class="schoolname" style="font-size: 15px;" class="site-title" href=""></a>
          <br/>
          <span style="margin-top: -2px;margin-bottom: -10px;" class="site-title"><a href="/l2ado/" title="Architecture des ordinateurs / Automne 2020 - "><b>Architecture des ordinateurs</a></b></span>
          <br/>
          <span class="coursesemeter" style="font-size: 12px;font-weight: bold;margin-top: 10px;display: block;">Automne 2020</span>
          </td>
        </tr></table>

    <nav class="site-nav">

      <a href="#" class="menu-icon menu.open">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>  

    <div class="trigger"><h1>Main Navigation</h1>

 <ul class="menu">
    
    <li>
        <a class="page-link" href="/l2ado/">
            <i class="fa fa-home fa-lg"></i> Accueil
        </a>
    </li>
    
    <li>
        <a class="page-link" href="/l2ado/schedule/">
            <i class="fas fa-calendar-alt"></i> Programme
        </a>
    </li>
    
    <li>
        <a class="page-link" href="/l2ado/lectures/">
            <i class="fas fa-book-reader"></i> Cours
        </a>
    </li>
    
    <li>
        <a class="page-link" href="/l2ado/labs/">
            <i class="fas fa-laptop-code"></i> Pratiques
        </a>
    </li>
    
    <li>
        <a class="page-link" href="/l2ado/assignments/">
            <i class="fas fa-user-graduate"></i> Devoirs
        </a>
    </li>
    
    <li>
        <a class="page-link" href="/l2ado/project/">
            <i class="fas fa-user-graduate"></i> Projet
        </a>
    </li>
    
    <li>
        <a class="page-link" href="/l2ado/materials/">
            <i class="fas fa-book"></i> Support
        </a>
    </li>
    
</ul>

     </div>  
    </nav>

  </div>

  <div class="header-texture" style="height:100%; z-index: 0; position: absolute; top:0; right: 0; left: 0; 
  background-image: url('/l2ado/_images/pattern.png');" />

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Travaux Pratiques #4 - Introduction à MARS</h1>
    <p class="post-meta">Publié le Thursday 19/09/2019</p>
  </header>

  <div>
    
    <span style="font-weight: bold">Date prévue : 
      <!-- 26/09/2019 -->

      
      Jeudi
      26
      
      Septembre
      2019
  

    </span>
    

    
    <p style="font-weight: bold">Télécharger

      

      
      [<a href="/l2ado/static_files/labs/lab_04.zip">démarrage</a>]
      

      

    </p>
    

  </div>

  <br />
  <article class="post-content">
    <h1 id="objectifs">Objectifs</h1>

<ul>
  <li>Get familiar with the MARS simulator.</li>
  <li>Learn how to assemble, run, and debug a MIPS program.</li>
</ul>

<h1 id="le-simulateur-mars">Le Simulateur MARS</h1>

<p>MARS, the Mips Assembly and Runtime Simulator, will assemble and simulate the execution of MIPS assembly language programs. It can be used either from a command line or through its integrated development environment (IDE). MARS is written in Java and requires at least Release 1.5 of the J2SE Java Runtime Environment (JRE) to work. It is distributed as an executable JAR file. The MARS home page is http://www.cs.missouristate.edu/MARS/.</p>

<p>There are two main windows in MARS, as shown in Figure 1.1.</p>
<ul>
  <li>The Edit window: used to create and modify a MIPS program</li>
  <li>The Execute window: used to run and debug a MIPS program</li>
</ul>

<p>To switch between the Edit and the Execute windows, use the tabs at the top.</p>

<p>The Execute window contains three main panes:</p>

<ol>
  <li>Text Segment: shows the machine code and related addresses.</li>
  <li>Data Segment: shows memory locations that hold variables in the data segment.</li>
  <li>Labels: shows addresses of labelled items, i.e. variables and jump endpoints.</li>
</ol>

<p>There are two tabbed message areas at the bottom of Figure 1.1:</p>
<ol>
  <li>The Mars Messages tab: Used for messages such as assembly or runtime errors and informational messages. You can click on assembly error messages to select the corresponding line of code in the editor.</li>
  <li>The Run I/O tab: Used at runtime for displaying console output and entering console input as program execution progresses.</li>
</ol>

<p>Figure 1.2 shows the MARS Execute window’s panes, and emphasizes the following features :</p>
<ol>
  <li>The Execute window’s tab.</li>
  <li>Assembly code displayed with addresses and machine code.</li>
  <li>Values stored in the data segment. These are directly editable.</li>
  <li>Controls for navigating the data memory area. Allows switching to view the stack segment.</li>
  <li>Switching between decimal and hexadecimal addresses and values in memory and registers.</li>
  <li>Labels and their corresponding memory addresses.</li>
  <li>Values stored in registers. These are directly editable.</li>
  <li>Checkboxes used to setup breakpoints for each MIPS instruction. Useful in debugging.</li>
  <li>Execution speed selection. Useful in debugging.</li>
</ol>

<p>At all times, the MIPS register window appears on the right-hand side of the screen, even when you are editing and not running a program. While writing a program, this serves as a useful reference for register names and their use. Move the mouse over the register name to see the tool tips.</p>

<p>There are three register tabs:</p>
<ul>
  <li>The Register File: integer registers $0 through $31, HI, LO, and the Program Counter PC.</li>
  <li>Coprocessor 0: exceptions, interrupts, and status codes.</li>
  <li>Coprocessor 1: floating point registers.</li>
</ul>

<h1 id="assemble-run-and-debug-a-mips-program">Assemble, Run, and Debug a MIPS Program</h1>

<p>To  assemble the file currently in the Edit tab, select Assemble from the Run menu, or use the Assemble toolbar icon.</p>

<p>If there are syntax errors in the program, they will appear in the Mars Messages tab at the bottom of the MARS screen. Each error message contains the line and column where the error occurred.</p>

<p>Once a MIPS program assembles successfully, the registers are initialized, and the Text Segment and the Data Segment are filled, as shown in Figure 1.3.</p>

<p>After running the Assemble command, you can now execute the program. The Run menu and the toolbar contain the following execution options :</p>

<p>You can set a breakpoint at any instruction by checking the checkbox in front of the instruction in the text segment pane.</p>

<p>During execution, the instruction being executed is highlighted in yellow, and the register that was last modified is highlighted in green. Also, the variable that was last updated in the data segment is highlighted  in  blue.  It’s  usually  only possible to see the highlighting when you are stepping or running at less than full speed.</p>

<p>For more details about the MARS simulator, refer to the MARS documentation at the following link: http://courses.missouristate.edu/KenVollmar/MARS</p>

<h1 id="in-lab-tasks">In-Lab Tasks</h1>

<ol>
  <li>Test a simple MIPS program. Consider the following program shown below :</li>
</ol>

<pre><code class="language-mips">
</code></pre>

<p>a) Type the program shown in the Figure above. 
b) Find out how to show and hide line numbers. 
c) Assemble and run the program. 
d) What output does the program produce? and where does it appear?</p>

<ol>
  <li>Explore the MARS simulator: 
a)   Download and assemble the Fibonacci.asm program from the MARS website. 
b)   Identify the locations and values of the initialized data. 
c)   Toggle the display format between decimal and hexadecimal. 
d)   Run the program at a speed of 3 instructions per second or less. 
e)   Single-step through the program and watch how register and memory values change. 
f)   Observe the output of the program in the Run I/O display window. 
g)   Set  a  breakpoint  at  the  first  instruction  that  prints  results. What is the address of this instruction? 
h)   Run the program at full speed and watch how it stops at the breakpoint. 
i)   Change the line:</li>
</ol>

<p>space: .asciiz “ “    # space to insert between numbers</p>

<p>to:</p>

<p>space: .asciiz “\n”   # space to insert between numbers</p>

<p>Run the program again. What do you notice?</p>

<p>La somme des carrés de <em>N</em> nombres entiers est décrit comme suit :</p>

\[sum = \sum_{i=0}^{N-1} n_i^2\]

<p>où \(n_0, n_1, ..., n_{N-1}\) sont des nombres entiers (de type <code class="language-plaintext highlighter-rouge">int</code>).</p>

<p>Télécharger le fichier de démarrage (voir plus haut dans ce document) et décompressez son contenu dans le répertoire de votre choix. Implémentez ensuite dans le fichier <code class="language-plaintext highlighter-rouge">SumOfSquares.s</code> le corps de la fonction <code class="language-plaintext highlighter-rouge">SumOfSquares</code> en assembleur MIPS et qui retourne dans le registre <code class="language-plaintext highlighter-rouge">$v0</code> la somme des carrés des éléments d’un tableau de <strong>words</strong>. Le nombre des éléments du tableau est donné dans le registre <code class="language-plaintext highlighter-rouge">$a0</code>, et l’adresse de début du tableau est donnée dans le registre <code class="language-plaintext highlighter-rouge">$a1</code>.</p>

<p><strong>INDICATION</strong> : Faites l’exercice n°1 du “<a href="/l2ado/labs/03_lab.html">TP Programmation « non structurée »</a>”, puis convertissez votre code C en assembleur MIPS à l’aide de la <a href="/l2ado/static_files/docs/iche_mips.pdf">fiche</a> de référence MIPS et du document <a href="/l2ado/static_files/docs/flow_control.pdf">contrôle de flux d’exécution dans MIPS</a>.</p>

<h1 id="exercice-2">Exercice 2</h1>

<p>Dans la bibliothèque standard du langage C, la fonction <code class="language-plaintext highlighter-rouge">strcmp</code> (cf. <code class="language-plaintext highlighter-rouge">man 3 strcmp</code>) compare, caractère par caractère, deux chaînes en mémoire pour établir quelle chaîne de caractère vient en premier dans l’ordre lexicographique standard, c.-à-d. en fonction des valeurs ASCII des caractères. Voici quelques exemples :</p>

<ul>
  <li>“a” &lt; “b”</li>
  <li>“abc” &lt; “abcd”</li>
  <li>“A” &lt; “a”</li>
</ul>

<p>Les chaînes de caractères à comparer sont représentées par des octets contigus en mémoire (chaque octet est un
caractère ASCII) suivi du caractère NUL (0x00).</p>

<p>Dans le fichier <code class="language-plaintext highlighter-rouge">StrCmp.s</code>, écrivez le corps de la fonction <code class="language-plaintext highlighter-rouge">StrCmp</code> en Assembleur MIPS.</p>

<p>Cette fonction doit retourner dans le registre <code class="language-plaintext highlighter-rouge">$v0</code> le résultat de la comparaison de deux chaînes de caractères. Si la première chaîne de caractères est inférieure à la second, alors <code class="language-plaintext highlighter-rouge">$v0</code> sera négatif. Si les deux chaînes de caractères sont semblables alors <code class="language-plaintext highlighter-rouge">$v0</code> sera nul. Enfin, si la première chaîne de caractères est supérieure à la seconde alors <code class="language-plaintext highlighter-rouge">$v0</code> sera positif.</p>

<p>L’adresse de la première (resp. deuxième) chaîne de caractères est donnée dans le registre <code class="language-plaintext highlighter-rouge">$a0</code> (resp. <code class="language-plaintext highlighter-rouge">$a1</code>).</p>

<p><strong>INDICATION</strong> : Faites l’exercice n°2 du “<a href="/l2ado/static_files/labs/03_lab.html">TP Programmation « non structurée »</a>”, puis convertissez votre code C en assembleur MIPS à l’aide de la <a href="/l2ado/static_files/docs/fiche_mips.pdf">fiche</a> de référence MIPS et du document <a href="/l2ado/static_files/docs/flow_control.pdf">contrôle de flux d’exécution dans MIPS</a>.</p>

<h2 id="exercice-3">Exercice 3</h2>

<p>Dans le fichier <code class="language-plaintext highlighter-rouge">InRange.s</code>, écrivez en assembleur MIPS le corp de la fonction <code class="language-plaintext highlighter-rouge">in_range(min, max, value)</code> qui retourne 1 dans <code class="language-plaintext highlighter-rouge">$v0</code> si <code class="language-plaintext highlighter-rouge">min &lt;= value &lt;= max</code> et 0 sinon. Vous pouvez supposer que :</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">min</code> est donnée dans le registre <code class="language-plaintext highlighter-rouge">$a0</code></li>
  <li><code class="language-plaintext highlighter-rouge">max</code> est donnée dans le registre <code class="language-plaintext highlighter-rouge">$a1</code></li>
  <li><code class="language-plaintext highlighter-rouge">value</code> est donnée dans le registre <code class="language-plaintext highlighter-rouge">$a2</code></li>
</ul>

<h1 id="exercice-4">Exercice 4</h1>

<p>Dans le fichier <code class="language-plaintext highlighter-rouge">Reverse.s</code>, écrivez en assembleur MIPS le corp de la fonction <code class="language-plaintext highlighter-rouge">reverse(int* array, int size)</code> qui inverse l’ordre des éléments du tableau <code class="language-plaintext highlighter-rouge">array</code>. Par exemple, si :</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">array</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">};</span>  
</code></pre></div></div>
<p>alors après application de la fonction <code class="language-plaintext highlighter-rouge">reverse</code> sur le tableau <code class="language-plaintext highlighter-rouge">array</code> le résultat devra être :</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">array</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">};</span>  
</code></pre></div></div>

<p>Pour notre fonction en assembleur MIPS, l’adresse du tableau <code class="language-plaintext highlighter-rouge">array</code> est donnée dans le registre <code class="language-plaintext highlighter-rouge">$a0</code> et le paramètre <code class="language-plaintext highlighter-rouge">size</code> est donné dans le registre <code class="language-plaintext highlighter-rouge">$a1</code>.</p>

  </article>

</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <!--     <h2 class="footer-heading"></h2> -->
    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">

        <p class="text">
          02 rue Didouche Mourad <br />
16000 Alger<br />

      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">


          

          

          

          

          




        </ul>
      </div>
    </div>

  </div>

</footer>

  </body>

</html>
